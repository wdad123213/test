{"version":3,"file":"index-DsjHW0DV.js","sources":["../../src/js/ajax.js","../../src/js/main.js"],"sourcesContent":["export default function ajax(option) {\r\n    return new Promise((resolve, reject) => {\r\n        let method = (option.type || 'GET').toUpperCase();\r\n        const data = option.data || {};\r\n        let type = option.str || 'form';\r\n\r\n        let querystring = Object.entries(data).map(item => item.join(\"=\")).join(\"&\")\r\n        let [url, search] = option.url.split('?')\r\n\r\n        querystring = search ? '&' + querystring : '?' + querystring\r\n\r\n        let xhr = new XMLHttpRequest();\r\n\r\n        method === 'GET' ? xhr.open('GET', option.url + querystring) : xhr.open('POST', option.url)\r\n\r\n        xhr.onreadystatechange = function () {\r\n            if (this.readyState === 4) {\r\n                if (this.status === 200) {\r\n                    let res = JSON.parse(this.responseText);\r\n                    resolve(res);\r\n                } else {\r\n                    reject(this.status)\r\n                }\r\n            }\r\n        }\r\n        if (method === 'GET') {\r\n            xhr.send()\r\n        } else if (method === 'POST') {\r\n            // json格式\r\n            if (type === 'JSON') {\r\n                xhr.setRequestHeader('Content-Type', 'application/json;charset=utf-8')\r\n                xhr.send(JSON.stringify(option.data))\r\n            } else { // 表单格式\r\n                xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded;charset=utf-8')\r\n                xhr.send(querystring)\r\n            }\r\n        }\r\n    })\r\n}","import '../css/style.scss'\nimport ajax from './ajax'\nimport { $, gets } from './common'\nimport BScroll from 'better-scroll'\n\n// 初始化\ngetList('https://zyxcl.xyz/exam_api/zh')\n    .then(res => localStorage.setItem('data', JSON.stringify(res)))\n\n// 头部导航点击事件\n$('ul', $('.top')).addEventListener('click', e => {\n    let target = e.target\n    if (target.nodeName === 'LI') {\n        $('.active').classList.remove('active')\n        target.classList.add('active')\n        switch (target.className) {\n            case 'synt active':\n                $('span', $('.sort')).className = 'iconfont icon-liebiao'\n                getList('https://zyxcl.xyz/exam_api/zh')\n                    .then(res => localStorage.setItem('data', JSON.stringify(res)))\n                break;\n            case 'sale active':\n                $('span', $('.sort')).className = 'iconfont icon-liebiao'\n                getList('https://zyxcl.xyz/exam_api/xl')\n                    .then(res => localStorage.setItem('data', JSON.stringify(res)))\n                break;\n            case 'new active':\n                $('span', $('.sort')).className = 'iconfont icon-liebiao'\n                getList('https://zyxcl.xyz/exam_api/sx')\n                    .then(res => localStorage.setItem('data', JSON.stringify(res)))\n                break;\n            case 'sort active':\n                const icon = target.firstElementChild\n                icon.className = icon.className === 'iconfont icon-liebiao' ?\n                    'iconfont icon-paixu-shengxu' : icon.className === 'iconfont icon-paixu-shengxu' ?\n                        'iconfont icon-paixu-jiangxu' : 'iconfont icon-paixu-shengxu'\n                const curData = JSON.parse(localStorage.getItem('data'))\n                let flag = false\n                if (icon.className === 'iconfont icon-paixu-shengxu') {\n                    flag = true\n                    dataSort(curData, flag)\n                } else {\n                    flag = false\n                    dataSort(curData, flag)\n                }\n                break;\n            case 'listType active':\n                $('span', $('.sort')).className = 'iconfont icon-liebiao'\n                const icon1 = target.firstElementChild\n                icon1.className = icon1.className === 'iconfont icon-pailiefangshi' ?\n                    'iconfont icon-pailiefangshi1' : 'iconfont icon-pailiefangshi'\n                const allData = JSON.parse(localStorage.getItem('data'))\n                render(allData)\n                break;\n        }\n    }\n})\n\n// 排序\nfunction dataSort(data, bol) {\n    const curData = data.items\n    if (bol) {\n        curData.sort((a, b) => a.price - b.price)\n        localStorage.setItem('data', JSON.stringify(curData))\n        render(curData)\n    } else {\n        curData.sort((a, b) => b.price - a.price)\n        render(curData)\n        localStorage.setItem('data', JSON.stringify(curData))\n    }\n}\n\n// 获取数据\nasync function getList(url) {\n    const data = await ajax({ url })\n    render(data)\n    return data\n}\n\n// 渲染函数\nfunction render(data) {\n    // 判断列表类型\n    let bol = false\n    let el = $('.listType').firstElementChild\n    if (el.className === 'iconfont icon-pailiefangshi1') {\n        bol = true\n    } else {\n        bol = false\n    }\n    const curData = data.items ? data.items : data\n    $('.con').innerHTML = bol ? '<ul>' + curData.map((item,i) => `\n        <li class=\"item\" data-index=\"${i}\">\n            <div class=\"left\">\n                <img src=\"${item.img}\" alt=\"\">\n            </div>\n            <div class=\"right\">\n                <p class=\"dd-h\">${item.title}</p>\n                <p class=\"dd-m\">月销<b class=\"num\">${item.sold}</b>笔</p>\n                <p class=\"dd-p\">￥<span class=\"price\">${item.price}</span></p>\n            </div>\n        </li>\n    `).join(\"\") + '</ul>' : '<div class=\"scroll\">' + curData.map((item,i) => `\n        <dl class=\"item\" data-index=\"${i}\">\n            <dt><img src=\"${item.img}\" alt=\"\"></dt>\n            <dd class=\"dd-h\">${item.title}</dd>\n            <dd class=\"dd-m\">月销<b class=\"num\">${item.sold}</b>笔</dd>\n            <dd class=\"dd-p\">￥<span class=\"price\">${item.price}</span></dd>\n        </dl>\n    `).join(\"\") + '</div>'\n    // 滚动\n    new BScroll('.con',{click:true})\n    setEvent()\n}\n\nfunction setEvent(){\n    $('.con').firstElementChild.addEventListener('click',e => {\n        if(e.target.className === 'item'){\n            location.assign(`./detail.html?index=${e.target.getAttribute('data-index')}`)\n        }\n    })\n}\n\n$('header p').addEventListener('click',e => {\n    location.assign(`./search.html`)\n})"],"names":["ajax","option","resolve","reject","method","data","type","querystring","item","url","search","xhr","res","getList","$","target","icon","curData","flag","dataSort","icon1","allData","render","bol","a","b","i","BScroll","setEvent"],"mappings":"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"}